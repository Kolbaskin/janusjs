/**
 * plugin.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */



tinymce.PluginManager.add('docsinsert', function(editor) {
    
    var addNewFile = function() {
        if(!Ext.fileDialog) {
            Ext.fileDialog = Ext.create('Crm.modules.docs.controller.Docs', {
                app: me.app
            })
        }
        Ext.fileDialog.openFileDialog({multi: true}, function(files) {
            if(files && files.length) 
                editor.insertContent(Ext.create('Ext.XTemplate', editor.userCfg.filesListTpl).compile().apply({list: files}));
        })
    }
   
   
	editor.addButton('docsinsert', {
    	//icon: 'object',
		text: 'Документ',
    	onclick: addNewFile,
		context: 'insert',
		prependToContext: true
	});

/*
	editor.addMenuItem('imageext', {
		icon: 'image',
		text: 'Insert image',
		onclick: createImageList(showDialog),
		context: 'insert',
		prependToContext: true
	});
*/
	//editor.addCommand('mceImageExt', createImageList(showDialog));
});

